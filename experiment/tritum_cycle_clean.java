import com.comsol.model.*;
import com.comsol.model.util.*;

public class tritum_cycle_clean {
  public static Model run() {
    Model model = ModelUtil.create("Model");

    // Global Parameters
    model.param().set("TBR", "1.1");
    model.param().set("beta", "0.06");
    model.param().set("lanmda", "1.78e-9[1/s]");
    model.param().set("fw", "0.0001");
    model.param().set("fd", "1E-4");
    model.param().set("fb", "0.99");
    model.param().set("fe", "0.98");
    model.param().set("Y13_Ini", "5000[g]");
    model.param().set("P", "3000[MW]");
    model.param().set("N_Para", "P/(6.515*beta)[MW/(g/day)]");
    model.param().set("N_flux", "0.459[kg/day]");
    model.param().set("I11_ini", "200[kg]");
    model.param().set("eta_f", "25/100");
    model.param().set("f_b", "0.36/100");
    model.param().set("f_e", "0.5");
    model.param().set("AF", "0.5");
    model.param().set("T_cycle", "3[h]");
    model.param().set("P_fusion", "1500[MW]");
    model.param().set("factor1", "1.7805E-06[g/s/(MW)]");
    model.param().set("I12_ini", "3.[kg]");
    model.param().set("I13_ini", "0.0[kg]");

    model.component().create("comp1", true);
    model.component("comp1").physics().create("ge", "GlobalEquations");
    model.component("comp1").physics("ge").prop("EquationForm").set("form", "Automatic");
    model.component("comp1").physics("ge").feature("ge1").set("CustomDependentVariableUnit", "1");
    model.component("comp1").physics("ge").feature("ge1").set("DependentVariableQuantity", "none");
    model.component("comp1").physics("ge").feature("ge1").set("CustomSourceTermUnit", "1");
    model.component("comp1").physics("ge").feature("ge1").set("SourceTermQuantity", "none");
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I1", 0);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I2", 1);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I3", 2);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I4", 3);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I5", 4);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I6", 5);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I7", 6);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I8", 7);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I9", 8);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I10", 9);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I11", 10);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I12", 11);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I13", 12);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I14", 13);
    model.component("comp1").physics("ge").feature("ge1").setIndex("name", "I15", 14);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 1);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 2);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 3);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 4);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 5);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 6);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 7);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 8);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 9);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 10);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "I12_ini", 11);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 12);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 13);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueU", "0", 14);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 1);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 2);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 3);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 4);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 5);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 6);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 7);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 8);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 9);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 10);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 11);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 12);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 13);
    model.component("comp1").physics("ge").feature("ge1").setIndex("initialValueUt", "0", 14);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "I1t", 0);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 1);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 2);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 3);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "I5t-f1_5*I1/tao1-I3/tao3", 4);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 5);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 6);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "I8t-I7/tao7+I8/T8", 7);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 8);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 9);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 10);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 11);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 12);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 13);
    model.component("comp1").physics("ge").feature("ge1").setIndex("equation", "1", 14);
    model.component("comp1").physics("ge").feature("ge1").setIndex("CustomDependentVariableUnit", "g", 0);
    model.component("comp1").physics("ge").feature("ge1").setIndex("CustomSourceTermUnit", "g/s", 0);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "Breeding Zone", 0);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "TES Unit", 1);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "TEP", 2);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "\u7b2c\u4e00\u58c1", 3);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "\u504f\u6ee4\u5668", 4);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "\u5305\u5c42", 5);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "Vacuum Pump", 6);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "Fuel Clean up", 7);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "TES", 9);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "I-ISS", 10);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "SDS", 11);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "O-ISS", 12);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "WDS", 13);
    model.component("comp1").physics("ge").feature("ge1").setIndex("description", "Plasma", 14);
    model.component("comp1").variable().create("var2");
    model.component("comp1").variable("var2").set("I2_flux", "if(I2>I2_sat, (I2-I2_sat)/T2, 0)");
    model.component("comp1").variable("var2").set("I9_flux", "if(I9>I9_sat, (I9-I9_sat)/T9, 0)");
    model.component("comp1").variable("var2").set("I10_flux", "if(I10>I10_sat, (I10-I10_sat)/T10, 0)");
    model.component("comp1").variable("var2").set("I11_flux", "if(I11>I11_sat, (I11-I11_sat)/T11, 0)");
    model.component("comp1").variable("var2").set("I13_flux", "if(I13>I13_sat, (I13-I13_sat)/T13, 0)");
    model.component("comp1").variable("var2").set("I14_flux", "if(I14>I14_sat, (I14-I14_sat)/T14, 0)");
    model.func().create("an1", "Analytic");
    model.func("an1").set("periodic", "true");
    model.func("an1").set("expr", "if(x<T_cycle*AF, 1, 0)");
    model.func("an1").set("periodicupper", "T_cycle");
    model.func("an1").set("fununit", "1");
    model.func("an1").set("funcname", "f_pulse");
    model.func("an1").set("dermethod", "automatic");
    model.func("an1").setIndex("plotargs", "3600*6", 0);
    model.func("an1").setIndex("argunit", "s", 0);
    model.variable().create("var1");
    model.variable("var1").set("N_flux", "f_pulse(t)*0.002654[g/s]");
    model.variable("var1").set("aa", "N_flux*3600");
    model.func().create("pw1", "Piecewise");
    model.func("pw1").set("argunit", "s");
    model.func("pw1").set("fununit", "1");
    model.func("pw1").setIndex("pieces", "1", 0);
    model.func("pw1").setIndex("pieces", "T_cycle*AF", 1);
    model.func("pw1").setIndex("pieces", "T_cycle*(1+AF)", 2);
    model.func("pw1").setIndex("pieces", "T_cycle*(2+0)", 3);
    model.func("pw1").setIndex("pieces", "T_cycle*(2+AF)", 4);
    model.func("pw1").setIndex("pieces", "T_cycle*(3+0)", 5);
    model.func("pw1").setIndex("pieces", "1", 6);
    model.func("pw1").setIndex("pieces", "0", 7);
    model.func("pw1").setIndex("pieces", "1", 8);
    model.func("pw1").setIndex("pieces", "0", 9);
    model.study().create("std1");
    model.study("std1").create("time", "Transient");
    model.study("std1").feature("time").set("tlist", "range(0,360,86400*300)");
    model.study("std1").create("batsw", "BatchSweep");
    model.study("std1").feature("batsw").set("sweeptype", "filled");
    model.study("std1").feature("batsw").set("maxallow", "3");
    model.study("std1").feature("batsw").set("accumtable", "tbl2");
    model.study("std1").feature("batsw").setIndex("pname", "beta", 0);
    model.study("std1").feature("batsw").setIndex("pname", "f_e", 1);
    model.study("std1").feature("batsw").setIndex("plistarr", "0.01 0.02 0.03", 0);
    model.study("std1").feature("batsw").setIndex("plistarr", "0.1 0.3 0.5", 1);
    model.sol().create("sol1");
    model.sol("sol1").create("st1", "StudyStep");
    model.sol("sol1").feature("st1").set("studystep", "time");
    model.sol("sol1").create("v1", "Variables");
    model.sol("sol1").feature("v1").set("control", "time");
    model.sol("sol1").create("t1", "Time");
    model.sol("sol1").feature("t1").set("tlist", "range(0,360,86400*30)");
    model.sol("sol1").feature("t1").set("plot", "off");
    model.sol("sol1").feature("t1").set("plotgroup", "pg1");
    model.sol("sol1").feature("t1").set("plotfreq", "tout");
    model.sol("sol1").feature("t1").set("probesel", "all");
    model.sol("sol1").feature("t1").set("probefreq", "tsteps");
    model.sol("sol1").feature("t1").set("atolglobalvaluemethod", "factor");
    model.sol("sol1").feature("t1").set("endtimeinterpolation", "true");
    model.sol("sol1").feature("t1").set("control", "time");
    model.sol("sol1").feature("t1").set("tstepsbdf", "strict");
    model.sol("sol1").feature("t1").set("maxstepconstraintbdf", "auto");
    model.sol("sol1").feature("t1").set("maxstepbdf", "1");
    model.sol("sol1").feature("t1").create("fc1", "FullyCoupled");
    model.sol("sol1").feature("t1").feature("fc1").set("linsolver", "dDef");
    model.sol().create("sol3");
    model.sol().create("sol7");
    model.sol().create("sol8");
    model.sol().create("sol9");
    model.sol().create("sol10");
    model.sol().create("sol2");
    model.result().numerical().create("gev1", "EvalGlobal");
    model.result().numerical("gev1").set("data", "dset1");
    model.result().numerical("gev1").set("table", "tbl1");
    model.result().table().create("tbl1", "Table");
    model.result().create("pg1", "PlotGroup1D");
    model.result("pg1").set("data", "dset1");
    model.result("pg1").set("xlog", "false");
    model.result("pg1").set("ylog", "false");
    model.result("pg1").set("ylabelactive", "true");
    model.result("pg1").set("ylabel", "\u76d8\u5b58\uff08kg\uff09");
    model.result("pg1").set("legendmaxwidthinside", "0.5");
    model.result("pg1").set("axislimits", "false");
    model.result("pg1").set("ymin", "6.263145850519937E-10");
    model.result().create("pg2", "result");
    model.result("pg2").set("ylog", "false");
    model.result("pg2").set("xlog", "false");
    model.result("pg2").set("legendpos", "lowerright");
    model.result("pg2").set("axislimits", "false");
    model.result("pg2").set("ymax", "1e4");
    model.result("pg2").set("ymin", "1e-3");
    model.result("pg2").set("xmin", "0.1");
    model.result("pg2").set("xmax", "1e4");
    model.result("pg2").set("data", "dset1");
    model.result("pg2").setIndex("looplevelinput", "all", 0);
    model.result("pg2").setIndex("looplevel", "new int[] { 1 }", 0);
    model.result().numerical().create("gev2", "EvalGlobal");
    model.result().numerical("gev2").set("data", "dset2");
    model.result().create("pg3", "PlotGroup1D");
    model.result("pg3").set("data", "dset2");
    model.result("pg3").set("ylog", "false");
    model.result("pg3").set("xlog", "false");
    model.result("pg3").set("legendpos", "upperleft");
    model.result("pg3").setIndex("looplevelinput", "manual", 0);
    model.result("pg3").setIndex("looplevelinput", "manual", 1);
    model.result("pg3").setIndex("looplevelinput", "manual", 2);
    model.result("pg3").setIndex("looplevel", "new int[] { 1 }", 0);
    model.result("pg3").setIndex("looplevel", "new int[] { 3 }", 1);
    model.result("pg3").setIndex("looplevel", "new int[] { 3 }", 2);
    model.result().create("pg5", "result");
    model.result("pg5").setIndex("looplevelinput", "manual", 0);
    model.result("pg5").setIndex("looplevel", "new int[] { 1 }", 0);
    model.result().table().create("tbl2", "Table");
    model.result().create("pg6", "PlotGroup1D");
    model.result("pg6").set("data", "dset2");
    return model;
  }

  public static void main(String[] args) {
    run();
  }
}